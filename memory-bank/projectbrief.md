# Leptos Marketplace - Project Brief

## Цель проекта

Создать полнофункциональную десктопную систему управления маркетплейсами с интеграцией 1С:Управление торговлей 11, Wildberries и Ozon на базе современного Rust full-stack стека (Leptos + Axum).

## Проблема, которую решаем

Компании, работающие с маркетплейсами и использующие 1С:УТ11, сталкиваются с проблемами:

- Ручная синхронизация данных между системами
- Отсутствие единого view на продажи и комиссии маркетплейсов
- Сложность аналитики по множественным каналам продаж
- Необходимость держать данные в разных системах

## Решение

Единое приложение, которое:

1. **Импортирует** справочники из 1С:УТ11 через OData
2. **Интегрируется** с API маркетплейсов (Wildberries, Ozon, Яндекс.Маркет, LemanaPro)
3. **Синхронизирует** товары, заказы, продажи, финансовые отчеты
4. **Агрегирует** данные для аналитики и отчетности
5. **Предоставляет** удобный веб-интерфейс для работы

## Ключевые функции

### Управление справочниками (Aggregates)

- **a001**: Подключения к 1С
- **a002**: Организации
- **a003**: Контрагенты
- **a004**: Номенклатура
- **a005**: Маркетплейсы
- **a006**: Подключения к маркетплейсам
- **a007**: Продукты маркетплейсов
- **a008**: Продажи маркетплейсов
- **a009**: Возвраты Ozon
- **a010**: FBS отгрузки Ozon
- **a011**: FBO отгрузки Ozon
- **a012**: Продажи Wildberries
- **a013**: Заказы Яндекс.Маркет
- **a014**: Транзакции Ozon
- **a015**: Заказы Wildberries
- **a016**: Возвраты Яндекс.Маркет

### Операции (UseCases)

- **u501**: Импорт справочников из 1С:УТ11 (организации, номенклатура, контрагенты)
- **u502**: Импорт данных из Ozon (транзакции, отгрузки, возвраты)
- **u503**: Импорт данных из Яндекс.Маркет (заказы, возвраты)
- **u504**: Импорт данных из Wildberries (продажи, заказы, финансовые отчеты)
- **u505**: Сопоставление номенклатуры (matching)
- **u506**: Интеграция с LemanaPro (аналитика, планирование)

### Аналитика (Projections)

- **p900**: Регистр продаж маркетплейсов (сводная таблица)
- **p901**: Штрих-коды номенклатуры
- **p902**: Финансовая реализация Ozon
- **p903**: Финансовый отчет Wildberries
- **p904**: Аналитика продаж (кросс-маркетплейс аналитика)
- **p905**: История комиссий Wildberries
- **p906**: Цены номенклатуры

## Технологический стек

### Frontend

- **Leptos 0.8**: Современный Rust фреймворк, компилируется в WASM
- **Thaw UI 0.5.0-beta**: Компонентная библиотека для Leptos
- **Reactive signals**: Реактивная система управления состоянием
- **CSS Variables**: Система темизации и стилей

### Backend

- **Axum 0.7**: Async web-фреймворк на Rust
- **SQLite**: Встроенная база данных (marketplace.db)
- **Sea-ORM 0.12**: ORM для работы с БД
- **Serde**: Сериализация/десериализация данных
- **Chrono**: Работа с датами и временем

### Architecture

- **DDD** (Domain-Driven Design): Разделение на домены
- **VSA** (Vertical Slice Architecture): Группировка по фичам, не слоям
- **Cargo Workspace**: 3 крейта (contracts, backend, frontend)
- **Indexed naming**: a001-a499 (агрегаты), u501-u999 (операции), p901-p999 (проекции)

## Целевая аудитория

- Малый/средний бизнес, работающий с маркетплейсами
- Использующие 1С:Управление торговлей 11
- Нужен единый инструмент для управления и аналитики

## Успех проекта измеряется

1. **Автоматизация**: Снижение ручного труда на синхронизацию данных
2. **Централизация**: Все данные в одном месте
3. **Аналитика**: Быстрый доступ к кросс-маркетплейс отчетам
4. **Надежность**: Стабильная работа интеграций
5. **Performance**: Быстрая загрузка больших объемов данных

## Ограничения и контекст

- **Desktop-first**: Приложение для локального запуска (не SaaS)
- **SQLite**: Не требует внешней БД, все в одном файле
- **Windows 11**: Основная платформа разработки и использования
- **Multi-user**: Поддержка нескольких пользователей с JWT авторизацией
- **Offline-capable**: Может работать без постоянного подключения к 1С

## Принципы разработки

1. **Simplicity first**: Начинаем с простого, усложняем при необходимости
2. **Type safety**: Максимум проверок на этапе компиляции
3. **Shared contracts**: Единые типы между frontend и backend
4. **Convention over configuration**: Соглашения об именовании вместо конфигов
5. **Vertical slices**: Группируем код по фичам, а не по техническим слоям
