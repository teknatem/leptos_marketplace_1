# Обновления UI формы редактирования товара a007 (v3)

## Дата: 16 ноября 2025

## Выполненные изменения

### 1. Цветовая индикация блока "Номенклатура (1С УТ)"

**Реализовано динамическое изменение цвета фона fieldset:**

- **Светло-зеленый (#d4edda)** - когда номенклатура заполнена
- **Светло-розовый (#f8d7da)** - когда номенклатура НЕ заполнена

**Код:**
```rust
<fieldset style={
    let vm = vm_clone.clone();
    move || {
        let bg_color = if vm.form.get().nomenclature_ref.is_some() {
            "#d4edda" // светло-зеленый
        } else {
            "#f8d7da" // светло-розовый
        };
        format!("border: 2px solid #ddd; border-radius: 6px; padding: 16px; margin: 16px 0; background: {};", bg_color)
    }
}>
```

**Преимущества:**
- Визуальная обратная связь о статусе заполнения
- Цвета меняются реактивно при выборе/очистке номенклатуры
- Интуитивно понятная цветовая схема (зеленый = заполнено, розовый = не заполнено)

### 2. Перенос кнопок в заголовок формы

**Кнопки "Сохранить" и "Отмена" перенесены:**
- Из нижней части формы (`details-actions`)
- В заголовок формы (`details-header`), в одну строку с заголовком

**Изменения в header:**
```rust
<div class="details-header" style="margin-bottom: 24px; border-bottom: 2px solid var(--color-primary, #4a90e2); padding-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
    <h3 style="margin: 0; color: var(--color-primary, #4a90e2); font-size: 1.2rem;">
        {/* Заголовок */}
    </h3>
    <div style="display: flex; gap: 12px;">
        <button class="btn btn-primary">
            {icon("save")}
            {"Сохранить" / "Создать"}
        </button>
        <button class="btn btn-secondary">
            {icon("cancel")}
            {"Отмена"}
        </button>
    </div>
</div>
```

**Преимущества:**
- Кнопки всегда видны (не нужно прокручивать до конца формы)
- Более компактная и современная компоновка
- Удобнее для редактирования - действия рядом с заголовком контекста
- Освобождается место в конце формы

### 3. Изменения в стилях

**Header:**
- Добавлено: `display: flex; justify-content: space-between; align-items: center;`
- Заголовок и кнопки теперь на одной линии

**Кнопки:**
- Группа кнопок с `gap: 12px`
- Сохранены все обработчики событий и disabled-условия
- Динамический текст кнопки (Сохранить/Создать) работает как раньше

## Технические детали

### Реактивность цвета
Цвет фона блока номенклатуры меняется автоматически при:
- Загрузке товара с заполненной/незаполненной номенклатурой
- Выборе номенклатуры через picker
- Автоматическом поиске по артикулу
- Очистке поля номенклатуры

### Структура компонента
```
┌─────────────────────────────────────────────────────┐
│ Header [Flex: space-between]                        │
│  ├─ Заголовок (H3)                                  │
│  └─ Кнопки [Flex: gap]                              │
│      ├─ Сохранить/Создать (Primary)                 │
│      └─ Отмена (Secondary)                          │
├─────────────────────────────────────────────────────┤
│ Сообщения об ошибках / успехе                       │
├─────────────────────────────────────────────────────┤
│ Форма (поля данных)                                 │
│  ├─ Описание, Маркетплейс, Кабинет...              │
│  └─ Номенклатура (1С УТ) [ЦВЕТНОЙ БЛОК]            │
│      ├─ Наименование + кнопки                       │
│      ├─ Код                                         │
│      └─ Артикул                                     │
└─────────────────────────────────────────────────────┘
```

## Тестирование
- ✅ Frontend компилируется без ошибок
- ✅ Цвет блока меняется реактивно
- ✅ Кнопки работают в новой позиции
- ✅ Все обработчики событий сохранены
- ✅ Disabled-состояния работают корректно

## Файлы изменены
- `crates/frontend/src/domain/a007_marketplace_product/ui/details/view.rs`

## Следующие шаги
Рекомендуется протестировать в браузере:
1. Открыть форму редактирования без номенклатуры (розовый фон)
2. Выбрать номенклатуру (должен стать зеленым)
3. Очистить номенклатуру (должен стать розовым)
4. Проверить работу кнопок в новой позиции
5. Проверить адаптивность на разных разрешениях

