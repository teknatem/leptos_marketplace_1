# ะะธะฑัะธะดะฝัะน Date Picker - ะคะธะฝะฐะปัะฝะฐั ะะตะฐะปะธะทะฐัะธั

## ะะฑะทะพั

ะะตะฐะปะธะทะพะฒะฐะฝ **ะณะธะฑัะธะดะฝัะน DateInput ะบะพะผะฟะพะฝะตะฝั** ะบะพัะพััะน:
- โ ะัะพะฑัะฐะถะฐะตั ะดะฐัั ะฒ ัะพัะผะฐัะต **dd.mm.yyyy**
- โ ะะพะทะฒะพะปัะตั **ะฒัะฑะธัะฐัั ะดะฐัั ะธะท ะบะฐะปะตะฝะดะฐัั** (ะบะปะธะบ ะฝะฐ ะฟะพะปะต)
- โ ะะพะดะดะตัะถะธะฒะฐะตั **ัััะฝะพะน ะฒะฒะพะด** ะฒ ัะพัะผะฐัะต dd.mm.yyyy
- โ ะะฝัััะตะฝะฝะต ัะฐะฑะพัะฐะตั ั yyyy-mm-dd (HTML ััะฐะฝะดะฐัั)

## ะะฐะบ ะะฐะฑะพัะฐะตั

### ะััะธัะตะบัััะฐ

ะะพะผะฟะพะฝะตะฝั ัะพััะพะธั ะธะท **ะดะฒัั ะฝะฐะปะพะถะตะฝะฝัั input ะฟะพะปะตะน**:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ะะธะดะธะผะพะต ัะตะบััะพะฒะพะต ะฟะพะปะต     โ โ ะะพะบะฐะทัะฒะฐะตั dd.mm.yyyy
โ  (type="text")              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
       โ ะฝะฐะบะปะฐะดัะฒะฐะตััั
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ะกะบััััะน date picker        โ โ ะัะบััะฒะฐะตั ะบะฐะปะตะฝะดะฐัั
โ  (type="date", opacity: 0)  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ะะธะดะธะผะพะต ะฟะพะปะต (ัะฒะตััั):**
- ะัะพะฑัะฐะถะฐะตั ะดะฐัั ะฒ ัะพัะผะฐัะต `dd.mm.yyyy`
- ะะพะทะฒะพะปัะตั ัััะฝะพะน ะฒะฒะพะด
- ะะฐััะธั ะฒะฒะตะดะตะฝะฝัะต ะดะฐะฝะฝัะต

**ะกะบัััะพะต ะฟะพะปะต (ะฟะพะด ะฝะธะผ):**
- ะัะพะทัะฐัะฝะพะต (opacity: 0)
- ะะตัะตัะฒะฐััะฒะฐะตั ะบะปะธะบะธ
- ะัะบััะฒะฐะตั ะฝะฐัะธะฒะฝัะน ะบะฐะปะตะฝะดะฐัั ะฑัะฐัะทะตัะฐ
- ะะตัะตะดะฐะตั ะฒัะฑัะฐะฝะฝัั ะดะฐัั

### ะะพะด DateInput

```rust
use chrono::NaiveDate;
use leptos::prelude::*;
use wasm_bindgen::JsCast;

#[component]
pub fn DateInput(
    #[prop(into)] value: Signal<String>,
    on_change: impl Fn(String) + 'static + Clone,
    #[prop(optional)] style: Option<String>,
) -> impl IntoView {
    // ะะพะฝะฒะตััะฐัะธั yyyy-mm-dd โ dd.mm.yyyy ะดะปั ะพัะพะฑัะฐะถะตะฝะธั
    let display_value = move || {
        let val = value.get();
        if let Ok(date) = NaiveDate::parse_from_str(&val, "%Y-%m-%d") {
            date.format("%d.%m.%Y").to_string()
        } else {
            val
        }
    };

    // ะะฑัะฐะฑะพัะบะฐ ัะตะบััะพะฒะพะณะพ ะฒะฒะพะดะฐ (dd.mm.yyyy)
    let handle_text_input = {
        let on_change = on_change.clone();
        move |ev: web_sys::Event| {
            if let Some(input) = ev.target()
                .and_then(|t| t.dyn_into::<web_sys::HtmlInputElement>().ok())
            {
                let val = input.value();
                if let Ok(date) = NaiveDate::parse_from_str(&val, "%d.%m.%Y") {
                    on_change(date.format("%Y-%m-%d").to_string());
                }
            }
        }
    };

    // ะะฑัะฐะฑะพัะบะฐ ะฒัะฑะพัะฐ ะธะท ะบะฐะปะตะฝะดะฐัั (yyyy-mm-dd)
    let handle_date_change = move |ev: web_sys::Event| {
        if let Some(input) = ev.target()
            .and_then(|t| t.dyn_into::<web_sys::HtmlInputElement>().ok())
        {
            let val = input.value();
            if !val.is_empty() {
                on_change(val);
            }
        }
    };

    view! {
        <div style="position: relative; display: inline-block;">
            <input
                type="text"
                prop:value=display_value
                on:input=handle_text_input
                on:change=handle_text_input
                placeholder="ะดะด.ะผะผ.ะณะณะณะณ"
                pattern="[0-9]{2}\\.[0-9]{2}\\.[0-9]{4}"
                maxlength="10"
            />
            
            <input
                type="date"
                prop:value=value
                on:change=handle_date_change
                style="position: absolute; left: 0; top: 0; width: 100%; height: 100%; opacity: 0; cursor: pointer; z-index: 1;"
            />
        </div>
    }
}
```

## ะะฑะฝะพะฒะปะตะฝะฝัะต ะะฝะพะฟะบะธ ะะตัะธะพะดะพะฒ

### ะะพะฒัะต ะะฐะดะฟะธัะธ

```
-1M   0M   โฏ
```

| ะะฝะพะฟะบะฐ | ะะฝะฐัะตะฝะธะต | ะะตะนััะฒะธะต |
|--------|----------|----------|
| **-1M** | ะะธะฝัั 1 ะผะตััั | ะฃััะฐะฝะฐะฒะปะธะฒะฐะตั ะฟัะตะดัะดััะธะน ะผะตััั |
| **0M** | ะัะปะตะฒะพะน (ัะตะบััะธะน) | ะฃััะฐะฝะฐะฒะปะธะฒะฐะตั ัะตะบััะธะน ะผะตััั |
| **โฏ** | ะะฝะพะณะพัะพัะธะต | ะัะบััะฒะฐะตั ะผะพะดะฐะปัะฝะพะต ะพะบะฝะพ ะฒัะฑะพัะฐ |

### ะัะตะธะผััะตััะฒะฐ ะะพะฒัั ะะฑะพะทะฝะฐัะตะฝะธะน

1. **-1M** - ะะฝััะธัะธะฒะฝะพ ะฟะพะฝััะฝะพ: "ะผะธะฝัั ะพะดะธะฝ ะผะตััั"
2. **0M** - ะะพะฝััะฝะพ: "ะฝัะปะตะฒะฐั ัะพัะบะฐ ะพัััะตัะฐ" = ัะตะณะพะดะฝั/ัะตะบััะธะน ะฟะตัะธะพะด
3. **โฏ** (ะณะพัะธะทะพะฝัะฐะปัะฝะพะต ะผะฝะพะณะพัะพัะธะต) - ะฃะฝะธะฒะตััะฐะปัะฝัะน ัะธะผะฒะพะป "ะตัะต ะพะฟัะธะธ"

### ะะพะด MonthSelector

```rust
let button_style = "padding: 6px 10px; border: 1px solid #ced4da; border-radius: 4px; font-size: 0.75rem; background: #fff; color: #495057; cursor: pointer; font-weight: 500; transition: all 0.2s ease; min-width: 42px; display: flex; align-items: center; justify-content: center;";

view! {
    <div style="display: flex; align-items: center; gap: 4px;">
        <button on:click=on_previous_month style=button_style title="ะัะตะดัะดััะธะน ะผะตััั">
            "-1M"
        </button>
        <button on:click=on_current_month style=button_style title="ะขะตะบััะธะน ะผะตััั">
            "0M"
        </button>
        <button on:click=on_open_picker style=button_style title="ะัะฑัะฐัั ะฟัะพะธะทะฒะพะปัะฝัะน ะฟะตัะธะพะด">
            "โฏ"
        </button>
    </div>
}
```

## ะัะพะณะพะฒัะน UI P904

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ๐ Sales Data (P904)        [ัะฒะตะดะพะผะปะตะฝะธะต] ๐ฅ ๐พ           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ะะตัะธะพะด: [ะดะด.ะผะผ.ะณะณะณะณ] โ [ะดะด.ะผะผ.ะณะณะณะณ]  -1M  0M  โฏ          โ
โ         โ ะบะปะธะบ = ะบะฐะปะตะฝะดะฐัั                                 โ
โ                                                             โ
โ ะะฐะฑะธะฝะตั: [โผ]              ๐ ะะฑะฝะพะฒะธัั  ๐ฅ ะญะบัะฟะพัั         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## Workflow ะะพะปัะทะพะฒะฐัะตะปั

### ะกัะตะฝะฐัะธะน 1: ะัะฑะพั ัะตัะตะท ะะฐะปะตะฝะดะฐัั
1. ะะพะปัะทะพะฒะฐัะตะปั ะบะปะธะบะฐะตั ะฝะฐ ะฟะพะปะต ะดะฐัั
2. ะัะบััะฒะฐะตััั **ะณัะฐัะธัะตัะบะธะน ะบะฐะปะตะฝะดะฐัั** ะฑัะฐัะทะตัะฐ
3. ะัะฑะธัะฐะตั ะดะฐัั ะผััะบะพะน
4. ะะฐัะฐ ัััะฐะฝะฐะฒะปะธะฒะฐะตััั ะธ ะพัะพะฑัะฐะถะฐะตััั ะบะฐะบ **25.12.2024**

### ะกัะตะฝะฐัะธะน 2: ะััะฝะพะน ะะฒะพะด
1. ะะพะปัะทะพะฒะฐัะตะปั ะบะปะธะบะฐะตั ะฝะฐ ะฟะพะปะต ะดะฐัั
2. ะะฒะพะดะธั ั ะบะปะฐะฒะธะฐัััั: `2 5 . 1 2 . 2 0 2 4`
3. ะัะธ ะฟะพัะตัะต ัะพะบััะฐ ะธะปะธ Enter - ะดะฐัะฐ ะฟะฐััะธััั ะธ ัะพััะฐะฝัะตััั
4. ะะพะปะต ะฟะพะบะฐะทัะฒะฐะตั **25.12.2024**

### ะกัะตะฝะฐัะธะน 3: ะัััััะน ะัะฑะพั ะะตัะธะพะดะฐ
1. ะะพะปัะทะพะฒะฐัะตะปั ัะพัะตั ะฟะพัะผะพััะตัั ะดะฐะฝะฝัะต ะทะฐ ะฟัะพัะปัะน ะผะตััั
2. ะะปะธะบ ะฝะฐ ะบะฝะพะฟะบั **-1M**
3. ะฃััะฐะฝะฐะฒะปะธะฒะฐะตััั ะฒะตัั ะฟัะตะดัะดััะธะน ะผะตััั (ั 1-ะณะพ ะฟะพ ะฟะพัะปะตะดะฝะตะต ัะธัะปะพ)
4. ะะฐัั ะพะฑะฝะพะฒะปััััั ะฐะฒัะพะผะฐัะธัะตัะบะธ

### ะกัะตะฝะฐัะธะน 4: ะัะฑะพั ะัะพะธะทะฒะพะปัะฝะพะณะพ ะะตัััะฐ
1. ะะพะปัะทะพะฒะฐัะตะปั ัะพัะตั ะดะฐะฝะฝัะต ะทะฐ ะธัะปั 2023
2. ะะปะธะบ ะฝะฐ ะบะฝะพะฟะบั **โฏ**
3. ะัะบััะฒะฐะตััั ะผะพะดะฐะปัะฝะพะต ะพะบะฝะพ
4. ะัะฑะธัะฐะตั ะผะตััั: ะัะปั, ะณะพะด: 2023
5. ะะปะธะบ "ะัะธะผะตะฝะธัั"
6. ะฃััะฐะฝะฐะฒะปะธะฒะฐะตััั ะฟะตัะธะพะด 01.07.2023 โ 31.07.2023

## ะขะตัะฝะธัะตัะบะธะต ะะตัะฐะปะธ

### ะัะตะพะฑัะฐะทะพะฒะฐะฝะธะต ะคะพัะผะฐัะพะฒ

```rust
// yyyy-mm-dd โ dd.mm.yyyy (ะดะปั ะพัะพะฑัะฐะถะตะฝะธั)
if let Ok(date) = NaiveDate::parse_from_str(&val, "%Y-%m-%d") {
    date.format("%d.%m.%Y").to_string()
}

// dd.mm.yyyy โ yyyy-mm-dd (ะดะปั ััะฐะฝะตะฝะธั)
if let Ok(date) = NaiveDate::parse_from_str(&val, "%d.%m.%Y") {
    date.format("%Y-%m-%d").to_string()
}
```

### CSS ะขััะบ ะดะปั ะะฐะปะพะถะตะฝะธั

```css
.container {
    position: relative;
    display: inline-block;
}

.text-input {
    /* ะะธะดะธะผะพะต ะฟะพะปะต */
}

.date-picker {
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    opacity: 0;        /* ะะตะฒะธะดะธะผะพะต */
    cursor: pointer;   /* ะัััะพั ัะบะฐะทะฐัะตะปั */
    z-index: 1;        /* ะะพะฒะตัั ัะตะบััะพะฒะพะณะพ ะฟะพะปั */
}
```

## ะกะพะฒะผะตััะธะผะพััั ั ะัะฐัะทะตัะฐะผะธ

### Desktop

| ะัะฐัะทะตั | ะะฐะปะตะฝะดะฐัั | ะคะพัะผะฐั |
|---------|-----------|--------|
| Chrome | โ ะะพะปะฝัะน | dd.mm.yyyy |
| Firefox | โ ะะพะปะฝัะน | dd.mm.yyyy |
| Edge | โ ะะพะปะฝัะน | dd.mm.yyyy |
| Safari | โ ะะฐัะธะฒะฝัะน | dd.mm.yyyy |

### Mobile

| ะะปะฐััะพัะผะฐ | ะะฐะปะตะฝะดะฐัั | ะคะพัะผะฐั |
|-----------|-----------|--------|
| Android Chrome | โ Touch-ะพะฟัะธะผะธะทะธัะพะฒะฐะฝ | dd.mm.yyyy |
| iOS Safari | โ ะะพะปะตัะพ ะฟัะพะบัััะบะธ | dd.mm.yyyy |

## ะัะตะธะผััะตััะฒะฐ ะะตัะตะฝะธั

1. **โ ะัะธะฒััะฝัะน ัะพัะผะฐั** - dd.mm.yyyy ะดะปั ััััะบะธั ะฟะพะปัะทะพะฒะฐัะตะปะตะน
2. **โ ะัะฐัะธัะตัะบะธะน ะฒัะฑะพั** - ะบะฐะปะตะฝะดะฐัั ะฟัะธ ะบะปะธะบะต
3. **โ ะััะฝะพะน ะฒะฒะพะด** - ะดะปั ะฑััััะพะณะพ ะฒะฒะพะดะฐ ั ะบะปะฐะฒะธะฐัััั
4. **โ ะะฐะปะธะดะฐัะธั** - ะฐะฒัะพะผะฐัะธัะตัะบะฐั ะฟัะพะฒะตัะบะฐ ะบะพััะตะบัะฝะพััะธ
5. **โ ะัะพัั-ะฑัะฐัะทะตัะฝะพััั** - ัะฐะฑะพัะฐะตั ะฒะตะทะดะต
6. **โ ะะพะฑะธะปัะฝะฐั ะพะฟัะธะผะธะทะฐัะธั** - ัะดะพะฑะฝะพ ะฝะฐ touch ััััะพะนััะฒะฐั
7. **โ Accessibility** - ะฟะพะดะดะตัะถะบะฐ ะบะปะฐะฒะธะฐัััั ะธ ัะบัะธะฝัะธะดะตัะพะฒ

## ะขะตััะธัะพะฒะฐะฝะธะต

### ะงะตะบ-ะปะธัั

1. **ะัะพะฑัะฐะถะตะฝะธะต:**
   - [ ] ะะฐัั ะฟะพะบะฐะทัะฒะฐัััั ะฒ ัะพัะผะฐัะต dd.mm.yyyy
   - [ ] ะะปะตะนััะพะปะดะตั "ะดะด.ะผะผ.ะณะณะณะณ" ะพัะพะฑัะฐะถะฐะตััั

2. **ะะฐะปะตะฝะดะฐัั:**
   - [ ] ะะปะธะบ ะฝะฐ ะฟะพะปะต "ะพั" ะพัะบััะฒะฐะตั ะบะฐะปะตะฝะดะฐัั
   - [ ] ะะปะธะบ ะฝะฐ ะฟะพะปะต "ะดะพ" ะพัะบััะฒะฐะตั ะบะฐะปะตะฝะดะฐัั
   - [ ] ะัะฑะพั ะดะฐัั ะธะท ะบะฐะปะตะฝะดะฐัั ัััะฐะฝะฐะฒะปะธะฒะฐะตั ะทะฝะฐัะตะฝะธะต
   - [ ] ะคะพัะผะฐั ะพััะฐะตััั dd.mm.yyyy

3. **ะััะฝะพะน ะฒะฒะพะด:**
   - [ ] ะะพะถะฝะพ ะฒะฒะตััะธ 25.12.2024
   - [ ] ะะตะบะพััะตะบัะฝัะน ัะพัะผะฐั ะฝะต ะฟัะธะฝะธะผะฐะตััั
   - [ ] ะัะธ ะฟะพัะตัะต ัะพะบััะฐ ะดะฐัะฐ ัะพััะฐะฝัะตััั

4. **ะะฝะพะฟะบะธ ะฟะตัะธะพะดะพะฒ:**
   - [ ] -1M ัััะฐะฝะฐะฒะปะธะฒะฐะตั ะฟัะตะดัะดััะธะน ะผะตััั
   - [ ] 0M ัััะฐะฝะฐะฒะปะธะฒะฐะตั ัะตะบััะธะน ะผะตััั
   - [ ] โฏ ะพัะบััะฒะฐะตั ะผะพะดะฐะปัะฝะพะต ะพะบะฝะพ

5. **ะกะพััะพัะฝะธะต:**
   - [ ] ะะตัะตะบะปััะตะฝะธะต ะฒะบะปะฐะดะพะบ ัะพััะฐะฝัะตั ะดะฐัั
   - [ ] ๐พ ัะพััะฐะฝัะตั ะฝะฐัััะพะนะบะธ ะฒ ะะ
   - [ ] ๐ฅ ะฒะพัััะฐะฝะฐะฒะปะธะฒะฐะตั ะฝะฐัััะพะนะบะธ

## ะคะฐะนะปั

**ะะทะผะตะฝะตะฝั:**
- `crates/frontend/src/shared/components/date_input.rs` - ะะธะฑัะธะดะฝัะน picker
- `crates/frontend/src/shared/components/month_selector.rs` - ะะพะฒัะต ะบะฝะพะฟะบะธ -1M, 0M, โฏ

**ะัะฟะพะปัะทัะตััั ะฒ:**
- `crates/frontend/src/projections/p904_sales_data/ui/list/mod.rs`

## ะัะธะผะตะฝะตะฝะธะต ะบ ะััะณะธะผ ะคะพัะผะฐะผ

ะะพะผะฟะพะฝะตะฝัั ะณะพัะพะฒั ะดะปั ะธัะฟะพะปัะทะพะฒะฐะฝะธั ะฒ ะดััะณะธั ัะพัะผะฐั. ะัะพััะพ ะธะผะฟะพััะธััะนัะต:

```rust
use crate::shared::components::date_input::DateInput;
use crate::shared::components::month_selector::MonthSelector;
```

ะ ะธัะฟะพะปัะทัะนัะต ัะฐะบ ะถะต, ะบะฐะบ ะฒ P904.

## ะัะพะณะธ

โ **ะะธะฑัะธะดะฝัะน Date Picker ัะตะฐะปะธะทะพะฒะฐะฝ**  
โ **ะคะพัะผะฐั dd.mm.yyyy ะพัะพะฑัะฐะถะฐะตััั**  
โ **ะะฐะปะตะฝะดะฐัั ัะฐะฑะพัะฐะตั ะฟัะธ ะบะปะธะบะต**  
โ **ะะฝะพะฟะบะธ ะพะฑะฝะพะฒะปะตะฝั: -1M, 0M, โฏ**  
โ **ะัะต ััะฝะบัะธะธ ะดะพัััะฟะฝั**  

ะะพัะพะฒะพ ะบ ะธัะฟะพะปัะทะพะฒะฐะฝะธั! ๐

