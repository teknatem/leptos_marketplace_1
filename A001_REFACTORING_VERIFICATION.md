# a001_connection_1c Refactoring Verification

## Изменения

Модуль `a001_connection_1c` был рефакторен для использования стандартных паттернов проекта:

### 1. ✅ Структура страницы

- **До**: Кастомная `div.connection-1c-list` с inline стилями
- **После**: Стандартная структура `.page` → `.header` → `.table`

### 2. ✅ Модальное окно

- **До**: Прямое использование `<Connection1CDetails show=... />`
- **После**: Обертка `<Show> + <Modal>` (как в a006_connection_mp)

### 3. ✅ Пагинация

- **До**: Встроена в градиентный header со сложными inline стилями
- **После**: Удалена из UI (backend поддержка сохранена для будущего добавления)

### 4. ✅ CSS классы

Все основные компоненты теперь используют стандартные классы:

- `.page` - контейнер страницы
- `.header` + `.header__content` + `.header__actions` - заголовок
- `.table` - обертка таблицы
- `.table__data`, `.table--striped` - стили таблицы
- `.table__head`, `.table__row`, `.table__cell` - элементы таблицы
- `.warning-box` - сообщения об ошибках

## Сохраненная функциональность

### ✅ Сортировка колонок

- Функция `toggle_sort` сохранена
- Sortable headers с индикаторами направления
- Защита от конфликта с resize

### ✅ Изменение размера колонок

- `init_column_resize` вызывается при монтировании
- Класс `.resizable` на header cells
- localStorage ключ: `a001_connection_1c_column_widths`

### ✅ Множественный выбор (checkboxes)

- `toggle_selection` для отдельных строк
- `toggle_all` для выбора всех
- `is_selected` для проверки состояния
- Компонент `<TableCheckbox>` используется

### ✅ Клик по строке

- `handle_edit` открывает модальное окно
- `on_row_click` на каждой `<tr>`
- Передается `id` для загрузки данных

### ✅ Кнопка "Новое"

- `handle_create_new` устанавливает `editing_id = None`
- Открывает модальное окно в режиме создания

## Проверка работоспособности

Для проверки рефакторинга:

1. **Запустите приложение**

   ```bash
   trunk serve
   ```

2. **Откройте список 1C подключений**

   - Перейдите на `http://localhost:8080/?active=a001_connection_1c`

3. **Проверьте функциональность**:
   - [ ] Список отображается в стандартном стиле
   - [ ] Кнопка "Новое" открывает модальное окно для создания
   - [ ] Клик по строке открывает модальное окно для редактирования
   - [ ] Сортировка работает при клике на заголовки колонок
   - [ ] Изменение размера колонок работает (drag на границе)
   - [ ] Checkboxes позволяют выбирать строки
   - [ ] Checkbox в header выбирает/снимает все строки
   - [ ] Модальное окно закрывается по кнопке закрытия
   - [ ] Модальное окно закрывается по клику на overlay
   - [ ] Модальное окно закрывается по Escape
   - [ ] После сохранения список обновляется

## Файлы изменены

- `crates/frontend/src/domain/a001_connection_1c/ui/list/mod.rs`
  - Добавлен импорт `Modal` компонента
  - Изменена структура `view!` с использованием стандартных CSS классов
  - Удалены функции пагинации `go_to_page` и `change_page_size`
  - Модальное окно обернуто в `<Show>` + `<Modal>`

## Консистентность с проектом

Теперь `a001_connection_1c` соответствует паттерну `a006_connection_mp`:

| Аспект           | a001_connection_1c                | a006_connection_mp                | Статус |
| ---------------- | --------------------------------- | --------------------------------- | ------ |
| Root container   | `.page`                           | `.page`                           | ✅     |
| Header structure | `.header` + `.header__actions`    | `.header` + `.header__actions`    | ✅     |
| Table wrapper    | `.table`                          | `.table`                          | ✅     |
| Modal pattern    | `<Show> + <Modal>`                | `<Show> + <Modal>`                | ✅     |
| Table classes    | `.table__data`, `.table--striped` | `.table__data`, `.table--striped` | ✅     |
| Error display    | `.warning-box`                    | `.warning-box`                    | ✅     |

## Дополнительные заметки

- Backend API для пагинации (`limit`, `offset`, `sort_by`, `sort_desc`) сохранен
- При необходимости пагинацию можно добавить как отдельный компонент
- Details компонент (`Connection1CDetails`) не изменялся - он имеет собственный header внутри модального окна
- Все функции сортировки, выбора и изменения размера сохранены и работают
